import{a as E,B as p,c as C,f as v,D as t,E as _,g as d,G as b,au as y,i as B,o as k}from"./index-Dz41ggC7.js";import{E as z}from"./el-pagination-D2RRFX8t.js";import{a as T,b as N}from"./el-table-column-CpKAGHtK.js";/* empty css                 */import{E as V}from"./index-CkMOv522.js";import{E as D}from"./index-DmBNINOK.js";import"./isEqual-BZuE2YcZ.js";import"./index-DHOeTWXz.js";const L={class:"user-list"},A={class:"page"},I=E({__name:"ListView",setup(F){const c=p([]);let g=p(0),u=p(1),i=p(11);const f=async(a=1,o=10)=>{await b.getCommunityList({page:a,pageSize:o}).then(e=>{let{code:l,total:n,result:s}=e;if(l==200){let r=s.map((m,x)=>(m.index=x+1,m));c.value=r,g.value=n}else console.log("获取社区动态列表失败")})},h=(a,o)=>{let{post_id:e}=o;console.log(e),V.confirm("是否删除这个动态?","提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{await b.removeCommunity({post_id:e}).then(l=>{let{code:n,msg:s}=l;n!=200&&D.error(s)}),c.value.splice(a,1)}).catch(()=>{console.log("点击取消")})},w=a=>{u.value=a,f(u.value,i.value)};return f(u.value,i.value),(a,o)=>{const e=N,l=y,n=T,s=z;return k(),C("div",L,[o[1]||(o[1]=v("h3",null,"社区管理",-1)),t(n,{data:c.value,style:{width:"100%"}},{default:_(()=>[t(e,{prop:"index",label:"序号",width:"100"}),t(e,{label:"用户",prop:"username"}),t(e,{label:"歌曲",prop:"song_name"}),t(e,{label:"分享描述",prop:"content","show-overflow-tooltip":"",width:"300"}),t(e,{label:"点赞数",prop:"like_count"}),t(e,{label:"评论数",prop:"comment_count"}),t(e,{label:"操作"},{default:_(r=>[t(l,{size:"small",type:"danger",onClick:m=>h(r.$index,r.row)},{default:_(()=>o[0]||(o[0]=[B(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),v("div",A,[t(s,{"page-size":d(i),"pager-count":d(i),layout:"prev, pager, next",total:d(g),onChange:w},null,8,["page-size","pager-count","total"])])])}}});export{I as default};
